<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Password Generator Tool</title>
<style>
  :root{
    --bg: #0f172a;
    --card: #111827;
    --muted: #94a3b8;
    --accent: #22d3ee;
    --good: #10b981;
    --warn: #f59e0b;
    --bad: #ef4444;
    --ring: rgba(34,211,238,.35);
  }
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100vh; display:grid; place-items:center;
    background: radial-gradient(1200px 800px at 70% -10%, #1f2937 0%, #0b1020 40%, var(--bg) 100%);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    color:#e5e7eb; padding:24px;
  }
  .card{
    width:min(700px, 96vw);
    background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.08);
    border-radius:20px; padding:22px;
    box-shadow: 0 10px 35px rgba(0,0,0,.4);
    backdrop-filter: blur(6px);
  }
  h1{ margin:0 0 6px; font-weight:700; letter-spacing:.3px; }
  .sub{ color:var(--muted); margin:0 0 18px; font-size:.95rem }

  .row{ display:flex; gap:12px; align-items:center; }
  .pw{
    flex:1; padding:14px 14px;
    border-radius:12px; border:1px solid rgba(255,255,255,.12);
    background: #0b1222; color:#fff; font-size:1.05rem;
    letter-spacing:.6px;
  }
  .btn{
    border:0; border-radius:12px; padding:12px 14px; cursor:pointer; font-weight:600;
    background: var(--accent); color:#02111a;
    transition:.15s transform ease, .15s filter ease, .15s box-shadow ease;
    box-shadow: 0 6px 22px var(--ring);
  }
  .btn:hover{ transform: translateY(-1px); filter:brightness(1.05) }
  .btn:active{ transform: translateY(0) scale(.99) }

  .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:18px; margin-top:16px }
  .group{
    border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:14px 14px 10px;
    background:#0b1222;
  }
  .group h3{ margin:0 0 10px; font-size:1rem; color:#cbd5e1 }
  .opt{ display:flex; gap:10px; align-items:center; margin:8px 0; font-size:.95rem; color:#d1d5db }
  .opt input[type="checkbox"]{ width:18px; height:18px }

  .len-row{ display:flex; align-items:center; gap:12px }
  input[type="range"]{ width:100% }
  .len-value{
    min-width:40px; text-align:center; font-weight:700; color:#fff;
    padding:4px 8px; background:#0a1426; border-radius:10px; border:1px solid rgba(255,255,255,.08);
  }

  .meter{
    margin-top:10px; height:10px; width:100%;
    background:#111827; border-radius:999px; overflow:hidden; border:1px solid rgba(255,255,255,.08)
  }
  .bar{ height:100%; width:0% ; background:linear-gradient(90deg, var(--bad), var(--warn), var(--good));
        transition: width .25s ease }
  .meta{ display:flex; justify-content:space-between; margin-top:8px; font-size:.9rem; color:var(--muted) }
  .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; color:#cbd5e1 }

  .row.wrap{flex-wrap:wrap}
  .note{ color:#9ca3af; font-size:.85rem; margin-top:8px }
  @media (max-width:720px){ .grid{ grid-template-columns: 1fr } }
</style>
</head>
<body>
  <div class="card">
    <h1>üîê Password Generator</h1>
    <p class="sub">Generate strong, customizable passwords with live strength & entropy.</p>

    <div class="row wrap">
      <input id="output" class="pw mono" type="text" readonly aria-label="Generated password"/>
      <button id="copyBtn" class="btn" aria-label="Copy password">Copy</button>
      <button id="genBtn" class="btn" aria-label="Generate password">Generate</button>
    </div>

    <div class="grid">
      <div class="group">
        <h3>Character Sets</h3>
        <label class="opt"><input id="lower" type="checkbox" checked/> Lowercase (a‚Äìz)</label>
        <label class="opt"><input id="upper" type="checkbox" checked/> Uppercase (A‚ÄìZ)</label>
        <label class="opt"><input id="nums"  type="checkbox" checked/> Numbers (0‚Äì9)</label>
        <label class="opt"><input id="syms"  type="checkbox" /> Symbols (!@#$...)</label>
        <div class="note">Tip: include at least 3 sets for strong passwords.</div>
      </div>

      <div class="group">
        <h3>Length & Rules</h3>
        <div class="len-row">
          <input id="length" type="range" min="4" max="64" value="16" />
          <div class="len-value mono" id="lenVal">16</div>
        </div>
        <label class="opt"><input id="noSimilar" type="checkbox"/> Exclude similar (O,0,l,1,I)</label>
        <label class="opt"><input id="noRepeat"  type="checkbox"/> Disallow repeated characters</label>
        <div class="meter"><div class="bar" id="strengthBar"></div></div>
        <div class="meta">
          <span id="strengthText">Strength: ‚Äî</span>
          <span class="mono" id="entropy">Entropy: ‚Äî</span>
        </div>
      </div>
    </div>

    <p class="note">Entropy is a theoretical estimate based on the selected character space and length.</p>
  </div>

<script>
(function(){
  const els = {
    out: document.getElementById('output'),
    copy: document.getElementById('copyBtn'),
    gen: document.getElementById('genBtn'),
    len: document.getElementById('length'),
    lenVal: document.getElementById('lenVal'),
    lower: document.getElementById('lower'),
    upper: document.getElementById('upper'),
    nums: document.getElementById('nums'),
    syms: document.getElementById('syms'),
    noSimilar: document.getElementById('noSimilar'),
    noRepeat: document.getElementById('noRepeat'),
    bar: document.getElementById('strengthBar'),
    strengthText: document.getElementById('strengthText'),
    entropy: document.getElementById('entropy')
  };

  const SETS = {
    lower: "abcdefghijklmnopqrstuvwxyz",
    upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
    nums:  "0123456789",
    syms:  "!@#$%^&*()-_=+[]{};:,.<>/?~"
  };
  const SIMILAR = new Set(['O','0','o','l','1','I']);

  function buildPool(){
    let pool = "";
    if(els.lower.checked) pool += SETS.lower;
    if(els.upper.checked) pool += SETS.upper;
    if(els.nums.checked)  pool += SETS.nums;
    if(els.syms.checked)  pool += SETS.syms;
    if(els.noSimilar.checked){
      pool = [...pool].filter(ch => !SIMILAR.has(ch)).join('');
    }
    return pool;
  }

  // Ensure at least one from each selected set gets included
  function generate(){
    const length = +els.len.value;
    const pool = buildPool();
    if(!pool){
      els.out.value = "Select at least one character set.";
      updateStrength(""); 
      return;
    }

    const selectedSets = [];
    if(els.lower.checked) selectedSets.push(SETS.lower);
    if(els.upper.checked) selectedSets.push(SETS.upper);
    if(els.nums.checked)  selectedSets.push(SETS.nums);
    if(els.syms.checked)  selectedSets.push(SETS.syms);

    // Apply "no similar" filter to individual sets too
    const filteredSets = selectedSets.map(s => els.noSimilar.checked ? [...s].filter(ch=>!SIMILAR.has(ch)).join('') : s);

    // Start with one char from each chosen set (for coverage)
    let chars = [];
    filteredSets.forEach(s => {
      if (s.length) chars.push(randomChar(s));
    });

    // Fill remaining
    while(chars.length < length){
      const ch = randomChar(pool);
      if(els.noRepeat.checked && chars.includes(ch)) continue;
      chars.push(ch);
    }

    // Shuffle to avoid predictable group order
    shuffle(chars);
    // If no repeat rule is on and length > unique pool size, trim to possible max
    if(els.noRepeat.checked){
      const uniquePool = new Set(pool.split(''));
      if(length > uniquePool.size){
        chars = chars.slice(0, uniquePool.size);
      }
    }

    const pwd = chars.slice(0,length).join('');
    els.out.value = pwd;
    updateStrength(pwd, pool.length);
  }

  function randomChar(str){
    const arr = typeof str === 'string' ? str : [...str].join('');
    const idx = crypto.getRandomValues(new Uint32Array(1))[0] % arr.length;
    return arr[idx];
  }

  function shuffle(arr){
    // Fisher‚ÄìYates with crypto RNG
    for(let i = arr.length -1; i > 0; i--){
      const r = crypto.getRandomValues(new Uint32Array(1))[0] % (i+1);
      [arr[i], arr[r]] = [arr[r], arr[i]];
    }
  }

  function log2(x){ return Math.log(x) / Math.log(2); }

  function updateStrength(pwd, poolSize=0){
    if(!pwd){ 
      els.bar.style.width = '0%';
      els.strengthText.textContent = 'Strength: ‚Äî';
      els.entropy.textContent = 'Entropy: ‚Äî';
      return;
    }
    // Entropy estimate = log2(poolSize^length) = length * log2(poolSize)
    const H = Math.round(pwd.length * log2(Math.max(poolSize,1)));
    els.entropy.textContent = `Entropy: ${H} bits`;

    // Simple classification thresholds
    let pct = 0, label = 'Very Weak', color = 'var(--bad)';
    if(H >= 30){ pct=25; label='Weak'; color='var(--bad)'; }
    if(H >= 45){ pct=50; label='Okay'; color='var(--warn)'; }
    if(H >= 65){ pct=75; label='Strong'; color='var(--good)'; }
    if(H >= 90){ pct=100; label='Excellent'; color='var(--good)'; }

    els.bar.style.width = pct + '%';
    els.bar.style.background = `linear-gradient(90deg, var(--bad), var(--warn), var(--good))`;
    els.strengthText.textContent = `Strength: ${label}`;
  }

  function copy(){
    const val = els.out.value.trim();
    if(!val || val.startsWith('Select')){
      toast('Nothing to copy');
      return;
    }
    navigator.clipboard.writeText(val).then(()=> toast('Copied!'));
  }

  function toast(msg){
    els.copy.textContent = msg;
    setTimeout(()=> els.copy.textContent = 'Copy', 900);
  }

  // Events
  els.gen.addEventListener('click', generate);
  els.copy.addEventListener('click', copy);
  [els.len, els.lower, els.upper, els.nums, els.syms, els.noSimilar, els.noRepeat]
    .forEach(el => el.addEventListener('input', () => {
      els.lenVal.textContent = els.len.value;
      // auto-regenerate on any change
      generate();
    }));

  // Init
  els.lenVal.textContent = els.len.value;
  generate();
})();
</script>
</body>
</html>
